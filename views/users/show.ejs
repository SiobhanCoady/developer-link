<%- include('../partials/header') %>

<div class="container">
  <%# SHOW DEVELOPER %>
  <% if (user.userType === 'developer') { %>
    <h1><%= user.firstName %> <%= user.lastName %></h1>

    <p><%= user.description %></p>
    <p>Email: <%= user.email %></p>
    <p>Website: <%= user.website %></p>
    <p>GitHub: <%= user.github %></p>
    <p>LinkedIn: <%= user.linkedin %></p>
    <p>Country: <%= user.country %></p>

    <p>Charity Types:
      <% for (let tag of tags) { %>
        <% if (tag.tagType === 'charityType') { %>
          <div class="chip"><%= tag.name %></div>
        <% } %>
      <% } %>
    </p>

    <p>Technologies:
      <% for (let tag of tags) { %>
        <% if (tag.tagType === 'technology') { %>
          <div class="chip"><%= tag.name %></div>
        <% } %>
      <% } %>
    </p>

    <p>Languages:
      <% for (let tag of tags) { %>
        <% if (tag.tagType === 'language') { %>
          <div class="chip"><%= tag.name %></div>
        <% } %>
      <% } %>
    </p>

  <%# SHOW NONPROFIT %>
  <% } else { %>
    <h1><%= user.orgName %></h1>

    <p><%= user.description %></p>
    <p>Charity Type: <%= user.charityType %></p>
    <p>Email: <%= user.email %></p>
    <p>Website: <%= user.website %></p>
    <p>Country: <%= user.country %></p>
    <h3>Projects</h3>
    <% if (projects.length > 0) { %>
      <ul class="user-projects-list">
        <% for (let project of projects) { %>
          <li>
            <p><%= project.title %></p>
            <p><%= project.description %></p>
            <p>Deadline: <%= project.deadline %></p>
            <p>GitHub: <%= project.github %></p>
            <hr>
          </li>
        <% } %>
      </ul>
    <% } else { %>
      <p>This nonprofit does not currently have any projects listed.</p>
    <% } %>

  <% } %>

  <hr>

  <% if (currentUser && currentUser.id !== user.id) { %>
    <h3>Leave a Review</h3>

    <div class="row">
      <form class="col s12" action="/users/<%= user.id %>/reviews" method="post">
        <div class="row">
          <div class="input-field col s12">
            <textarea name="body" id="body" class="materialize-textarea"></textarea>
            <label for="body">Body</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <input name="rating" id="rating" type="number" min="1" max="5" step="1" class="validate">
            <label for="rating">Rating</label>
          </div>
        </div>
        <button class="btn waves-effect waves-light" type="submit" name="action">Submit
        </button>
      </form>
    </div>
  <% } %>

  <h3>Reviews</h3>

  <ul class="reviews-list">
    <% for (let review of reviews) { %>
      <li>
        <p><%= review.body %></p>
        <p><%= review.reviewer.firstName %> <%= review.reviewer.lastName %></p>
        <p><strong>Rating: </strong><%= review.rating %></p>
        <p><strong>Created At: </strong><%= review.createdAt %></p>
        <hr>
      </li>
    <% } %>
  </ul>
</div>

<%- include('../partials/footer') %>
